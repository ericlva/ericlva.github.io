---
layout: post
title: "ruby 2.1 安装openssl扩展"
date: 2014-05-19 13:01
comments: true
categories: dev
tags: [openssl,ruby]
---

当下载/编译安装完最新的ruby2.1后,安装某些gem时需要openssl.
基本的步骤是:

```bash
cd {ruby源码路径}/ext/openssl
ruby extconf.rb
make
make install
```

但当你make的时候会提示

```bash
make: *** No rule to make target `/thread_native.h', needed by `ossl.o'.  Stop.
```

报错的意思就是找不到'thread_native.h'文件
其实是{ruby源码路径}/ext/openssl/Makefile中忘了给路径变量top_srcdir赋值,调用的时候当然就报错了

```
ossl.o: $(top_srcdir)/thread_native.h $(top_srcdir)/thread_$(THREAD_MODEL).h
```

这个文件其实就在ruby源码包里,解决方法请看下面第3行:

```
srcdir = .
topdir = /usr/local/include/ruby-2.1.0
top_srcdir = {ruby源码路径}
hdrdir = $(topdir)
arch_hdrdir = /usr/local/include/ruby-2.1.0/x86_64-linux
```

接着继续make && make install即可

参考: http://stackoverflow.com/questions/21498868/install-openssl-support-for-selfcompiled-ruby-installation